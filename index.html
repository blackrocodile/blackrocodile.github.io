<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>ArcGIS API for a scene</title>
  <style>
    html, body, #viewDiv {
      padding: 0;
      margin: 0;
      height: 100%;
      width: 100%;
    }
  </style>

  <link rel="stylesheet" href="https://js.arcgis.com/4.21/esri/themes/light/main.css">
  <script src="https://js.arcgis.com/4.21/"></script>

  <script>
    require([
      "esri/config",
      "esri/Map",
      "esri/views/MapView", 
      "esri/Graphic", 
      "esri/layers/GraphicsLayer",
      "esri/layers/FeatureLayer",
      "esri/views/SceneView",
      "esri/layers/ElevationLayer",
      "esri/layers/BaseElevationLayer",
      "esri/Basemap",
      "esri/layers/TileLayer",
      "esri/widgets/BasemapToggle",
      "esri/widgets/BasemapGallery"
  ], function(esriConfig,Map, MapView, Graphic, GraphicsLayer, FeatureLayer, SceneView,ElevationLayer, BaseElevationLayer, Basemap, TileLayer,BasemapToggle, BasemapGallery) {
      esriConfig.apiKey = "AAPK6e70f2b3e075441bb629b12b62345c98bJhIHSKIQr60Qs55jwj9Xp1E-Vo8ciOhlQMUi8ShQKFxvvLVfEa0xhJBmyKc6ng6";
      
      const map = new Map({
      basemap: "arcgis-topographic", //Basemap layer service
      ground: "world-elevation", //Elevation service
    });
      
      const graphicsLayer = new GraphicsLayer();
      
      
      
      // Create a polygon geometry
      const polygon = {
        type: "polygon",
        rings: [
          [8.531020,47.388154], //Longitude, latitude //1
          [8.534437,47.386254], //2
          [8.536336,47.385004], //3
          [8.536433,47.385055], //4
          [8.538085,47.384300], //5
          [8.538665,47.383900], //6
          [8.539169,47.383459], //7
          [8.539094,47.383292], //8
          [8.540035,47.382869], //9
          [8.539947,47.382632], //10
          [8.541867,47.379927], //11
          [8.538480,47.379322], //12
          [8.529119,47.377035], //13
          [8.523188,47.379851], //14
          [8.507846,47.395345], //15
          [8.514949,47.394415], //16
          [8.522459,47.392294], //17
          [8.526192,47.390900], //18

        ]
      };
      
      const simpleFillSymbol = {
        type: "simple-fill",
        color: [58,173,148, 0.8],  // Orange, opacity 80%
        outline: {
          color: [55, 55, 55],
          width: 1
        }
      };
      
      const popupTemplate = {
        title: "{Name}",
        content: "{Description}"
      };
      
      const attributes = {
        Name: "Flood danger zone",
        Description: "Areas to be affected by floods when water level rises by 1-2 m"
      };
      
      const polygonGraphic = new Graphic({
        geometry: polygon,
        symbol: simpleFillSymbol,
        attributes: attributes,
        popupTemplate: popupTemplate
      });
      
      graphicsLayer.add(polygonGraphic);
      
      const view = new SceneView({
        container: "viewDiv",
        map: map,
        camera: {
          position: {
            x: 8.538, //Longitude //8.55 top-view //8.54 river-bed //8.538 city-center
            y: 47.373, //Latitude //47.35 top-view //47.31,47.373 river-bed //47.36 city-center
            z: 800 //Meters //20k top-view //10k,700 river-bed //880 city-center
            // 8.54, 47.373, 700
          },
          tilt: 72 //5 top-view //35 river-bed //72 city-center
        }
      });
      
      const basemapToggle = new BasemapToggle({
        view: view,
        nextBasemap: "arcgis-imagery"
      });
      
      view.ui.add(basemapToggle,"bottom-right");
      
      const basemapGallery = new BasemapGallery({
        view: view,
        source: 
        {
          query: 
          {
            title: '"World Basemaps for Developers" AND owner:esri'
          }
        }
      });
      
      view.ui.add(basemapGallery, "top-right"); // Add to the view 
      
      // Define a pop-up for informing on flood-danger zones
      const popupContour = {
        "title": "Height (contour) Information of Zurich",
        "content": "<b>Height:</b> {hoehe}<br><b>Countour length:</b> {Shape__Length}"
      };   
      // Define the feature layer for the pop-up
      const contour = new FeatureLayer({
        url: "https://services2.arcgis.com/cFEFS0EWrhfDeVw9/arcgis/rest/services/Zurich_Contour_Lines/FeatureServer/2",
        outFields: ["hoehe","Shape_Length"],
        popupTemplate: popupContour,
      });
      
      // Define a pop-up for informing on seismic events including tsunamis
      const popupSeismic = {
        "title": "Info on Seismic Activity",
        "content": "<b>eventType:</b> {eventType}<br><b>eventTime:</b> {eventTime}<br><b>place:</b> {place}<br><b>alert:</b> {alert}<br><b>updated:</b> {updated}<br><b>status:</b> {status}<br><b>detail:</b> {detail}<br><b>longitude:</b> {longitude}<br><b>latitude:</b> {latitude}<br><b>depth:</b> {depth}<br><b>tsunami:</b> {tsunami}"
      };
      // Define the feature layer for the pop-up
      const seismic = new FeatureLayer({
        url: "https://services9.arcgis.com/RHVPKKiFTONKtxq3/arcgis/rest/services/USGS_Seismic_Data_v1/FeatureServer/0",
        outFields: ["eventType", "eventTime", "place", "alert", "updated", "status", "detail", "longitude", "latitude", "depth", "tsunami"],
        popupTemplate: popupSeismic,
      });
      
      // Define a pop-up for gardens and the like around Zurich
      const popupGarden = {
        "title": "Parks & Gardens in Zurich",
        "content": "<b>Description:</b> {typ}<br><b>Public/Private:</b> {einstufung}<br><b>Location:</b> {inventarad}<br><b>Status:</b> {schutzstat}<br><b>Details:</b> {bezeichnun}"
      };   
      // Define the feature layer for the pop-up
      const garden = new FeatureLayer({
        url: "https://services2.arcgis.com/cFEFS0EWrhfDeVw9/arcgis/rest/services/Zurich_Parks_Parcels/FeatureServer/0",
        outFields: ["typ","einstufung","inventarad","schutzstat","bezeichnun"],
        popupTemplate: popupGarden,
      });
      
      // Define a pop-up for swiss glaciers to inform on potential flood-flow due to global warming
      const popupGlacier = {
        "title": "Swiss Glaciers",
        "content": "<b>Glacier name:</b> {Name}<br><b> Area (potential water-flow):</b> {Shape__Area}"
      };   
      // Define the feature layer for the pop-up
      const glacier = new FeatureLayer({
        url: "https://services.arcgis.com/XSeYKQzfXnEgju9o/arcgis/rest/services/Swiss_glaciers/FeatureServer/0",
        outFields: ["Name","Shape_Area"],
        popupTemplate: popupGlacier,
      });
      
      // add pop-ups to map // latest on top
      map.add(seismic);
      map.add(garden);
      map.add(glacier);
      
      map.add(contour);
      map.add(graphicsLayer);
      
    });
  </script>

</head>
<body>
  <div id="viewDiv"></div>
</body>
</html>
